/*! 
 * jQuery Form Plugin
 * version: 2.43 (12-MAR-2010)
 * @requires jQuery v1.3.2 or later
 *
 * Examples and documentation at: http://malsup.com/jquery/form/
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 */(function(e){function t(){if(e.fn.ajaxSubmit.debug){var t="[jquery.form] "+Array.prototype.join.call(arguments,"");window.console&&window.console.log?window.console.log(t):window.opera&&window.opera.postError&&window.opera.postError(t)}}e.fn.ajaxSubmit=function(n){function m(){function m(){var t=f.attr("target"),n=f.attr("action");r.setAttribute("target",o);r.getAttribute("method")!="POST"&&r.setAttribute("method","POST");r.getAttribute("action")!=i.url&&r.setAttribute("action",i.url);i.skipEncodingOverride||f.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"});i.timeout&&setTimeout(function(){p=!0;y()},i.timeout);var s=[];try{if(i.extraData)for(var a in i.extraData)s.push(e('<input type="hidden" name="'+a+'" value="'+i.extraData[a]+'" />').appendTo(r)[0]);u.appendTo("body");u.data("form-plugin-onload",y);r.submit()}finally{r.setAttribute("action",n);t?r.setAttribute("target",t):f.removeAttr("target");e(s).remove()}}function y(){if(h)return;var n=!0;try{if(p)throw"timeout";var r,s;s=a.contentWindow?a.contentWindow.document:a.contentDocument?a.contentDocument:a.document;var o=i.dataType=="xml"||s.XMLDocument||e.isXMLDoc(s);t("isXml="+o);if(!o&&(s.body==null||s.body.innerHTML=="")){if(--g){t("requeing onLoad callback, DOM not available");setTimeout(y,250);return}t("Could not access iframe DOM after 100 tries.");return}t("response detected");h=!0;l.responseText=s.body?s.body.innerHTML:null;l.responseXML=s.XMLDocument?s.XMLDocument:s;l.getResponseHeader=function(e){var t={"content-type":i.dataType};return t[e]};if(i.dataType=="json"||i.dataType=="script"){var f=s.getElementsByTagName("textarea")[0];if(f)l.responseText=f.value;else{var d=s.getElementsByTagName("pre")[0];d&&(l.responseText=d.innerHTML)}}else i.dataType=="xml"&&!l.responseXML&&l.responseText!=null&&(l.responseXML=b(l.responseText));r=e.httpData(l,i.dataType)}catch(v){t("error caught:",v);n=!1;l.error=v;e.handleError(i,l,"error",v)}if(n){i.success(r,"success");c&&e.event.trigger("ajaxSuccess",[l,i])}c&&e.event.trigger("ajaxComplete",[l,i]);c&&!--e.active&&e.event.trigger("ajaxStop");i.complete&&i.complete(l,n?"success":"error");setTimeout(function(){u.removeData("form-plugin-onload");u.remove();l.responseXML=null},100)}function b(e,t){if(window.ActiveXObject){t=new ActiveXObject("Microsoft.XMLDOM");t.async="false";t.loadXML(e)}else t=(new DOMParser).parseFromString(e,"text/xml");return t&&t.documentElement&&t.documentElement.tagName!="parsererror"?t:null}var r=f[0];if(e(":input[name=submit]",r).length){alert('Error: Form elements must not be named "submit".');return}var i=e.extend({},e.ajaxSettings,n),s=e.extend(!0,{},e.extend(!0,{},e.ajaxSettings),i),o="jqFormIO"+(new Date).getTime(),u=e('<iframe id="'+o+'" name="'+o+'" src="'+i.iframeSrc+'" onload="(jQuery(this).data(\'form-plugin-onload\'))()" />'),a=u[0];u.css({position:"absolute",top:"-1000px",left:"-1000px"});var l={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(){this.aborted=1;u.attr("src",i.iframeSrc)}},c=i.global;c&&!(e.active++)&&e.event.trigger("ajaxStart");c&&e.event.trigger("ajaxSend",[l,i]);if(s.beforeSend&&s.beforeSend(l,s)===!1){s.global&&e.active--;return}if(l.aborted)return;var h=!1,p=0,d=r.clk;if(d){var v=d.name;if(v&&!d.disabled){i.extraData=i.extraData||{};i.extraData[v]=d.value;if(d.type=="image"){i.extraData[v+".x"]=r.clk_x;i.extraData[v+".y"]=r.clk_y}}}i.forceSync?m():setTimeout(m,10);var g=100}if(!this.length){t("ajaxSubmit: skipping submit process - no element selected");return this}typeof n=="function"&&(n={success:n});var r=e.trim(this.attr("action"));r&&(r=(r.match(/^([^#]+)/)||[])[1]);r=r||window.location.href||"";n=e.extend({url:r,type:this.attr("method")||"GET",iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},n||{});var i={};this.trigger("form-pre-serialize",[this,n,i]);if(i.veto){t("ajaxSubmit: submit vetoed via form-pre-serialize trigger");return this}if(n.beforeSerialize&&n.beforeSerialize(this,n)===!1){t("ajaxSubmit: submit aborted via beforeSerialize callback");return this}var s=this.formToArray(n.semantic);if(n.data){n.extraData=n.data;for(var o in n.data)if(n.data[o]instanceof Array)for(var u in n.data[o])s.push({name:o,value:n.data[o][u]});else s.push({name:o,value:n.data[o]})}if(n.beforeSubmit&&n.beforeSubmit(s,this,n)===!1){t("ajaxSubmit: submit aborted via beforeSubmit callback");return this}this.trigger("form-submit-validate",[s,this,n,i]);if(i.veto){t("ajaxSubmit: submit vetoed via form-submit-validate trigger");return this}var a=e.param(s);if(n.type.toUpperCase()=="GET"){n.url+=(n.url.indexOf("?")>=0?"&":"?")+a;n.data=null}else n.data=a;var f=this,l=[];n.resetForm&&l.push(function(){f.resetForm()});n.clearForm&&l.push(function(){f.clearForm()});if(!n.dataType&&n.target){var c=n.success||function(){};l.push(function(t){var r=n.replaceTarget?"replaceWith":"html";e(n.target)[r](t).each(c,arguments)})}else n.success&&l.push(n.success);n.success=function(e,t,r){for(var i=0,s=l.length;i<s;i++)l[i].apply(n,[e,t,r||f,f])};var h=e("input:file",this).fieldValue(),p=!1;for(var d=0;d<h.length;d++)h[d]&&(p=!0);var v=!1;h.length&&n.iframe!==!1||n.iframe||p||v?n.closeKeepAlive?e.get(n.closeKeepAlive,m):m():e.ajax(n);this.trigger("form-submit-notify",[this,n]);return this};e.fn.ajaxForm=function(t){return this.ajaxFormUnbind().bind("submit.form-plugin",function(n){n.preventDefault();e(this).ajaxSubmit(t)}).bind("click.form-plugin",function(t){var n=t.target,r=e(n);if(!r.is(":submit,input:image")){var i=r.closest(":submit");if(i.length==0)return;n=i[0]}var s=this;s.clk=n;if(n.type=="image")if(t.offsetX!=undefined){s.clk_x=t.offsetX;s.clk_y=t.offsetY}else if(typeof e.fn.offset=="function"){var o=r.offset();s.clk_x=t.pageX-o.left;s.clk_y=t.pageY-o.top}else{s.clk_x=t.pageX-n.offsetLeft;s.clk_y=t.pageY-n.offsetTop}setTimeout(function(){s.clk=s.clk_x=s.clk_y=null},100)})};e.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")};e.fn.formToArray=function(t){var n=[];if(this.length==0)return n;var r=this[0],i=t?r.getElementsByTagName("*"):r.elements;if(!i)return n;for(var s=0,o=i.length;s<o;s++){var u=i[s],a=u.name;if(!a)continue;if(t&&r.clk&&u.type=="image"){if(!u.disabled&&r.clk==u){n.push({name:a,value:e(u).val()});n.push({name:a+".x",value:r.clk_x},{name:a+".y",value:r.clk_y})}continue}var f=e.fieldValue(u,!0);if(f&&f.constructor==Array)for(var l=0,c=f.length;l<c;l++)n.push({name:a,value:f[l]});else f!==null&&typeof f!="undefined"&&n.push({name:a,value:f})}if(!t&&r.clk){var h=e(r.clk),p=h[0],a=p.name;if(a&&!p.disabled&&p.type=="image"){n.push({name:a,value:h.val()});n.push({name:a+".x",value:r.clk_x},{name:a+".y",value:r.clk_y})}}return n};e.fn.formSerialize=function(t){return e.param(this.formToArray(t))};e.fn.fieldSerialize=function(t){var n=[];this.each(function(){var r=this.name;if(!r)return;var i=e.fieldValue(this,t);if(i&&i.constructor==Array)for(var s=0,o=i.length;s<o;s++)n.push({name:r,value:i[s]});else i!==null&&typeof i!="undefined"&&n.push({name:this.name,value:i})});return e.param(n)};e.fn.fieldValue=function(t){for(var n=[],r=0,i=this.length;r<i;r++){var s=this[r],o=e.fieldValue(s,t);if(o===null||typeof o=="undefined"||o.constructor==Array&&!o.length)continue;o.constructor==Array?e.merge(n,o):n.push(o)}return n};e.fieldValue=function(e,t){var n=e.name,r=e.type,i=e.tagName.toLowerCase();typeof t=="undefined"&&(t=!0);if(t&&(!n||e.disabled||r=="reset"||r=="button"||(r=="checkbox"||r=="radio")&&!e.checked||(r=="submit"||r=="image")&&e.form&&e.form.clk!=e||i=="select"&&e.selectedIndex==-1))return null;if(i=="select"){var s=e.selectedIndex;if(s<0)return null;var o=[],u=e.options,a=r=="select-one",f=a?s+1:u.length;for(var l=a?s:0;l<f;l++){var c=u[l];if(c.selected){var h=c.value;h||(h=c.attributes&&c.attributes.value&&!c.attributes.value.specified?c.text:c.value);if(a)return h;o.push(h)}}return o}return e.value};e.fn.clearForm=function(){return this.each(function(){e("input,select,textarea",this).clearFields()})};e.fn.clearFields=e.fn.clearInputs=function(){return this.each(function(){var e=this.type,t=this.tagName.toLowerCase();e=="text"||e=="password"||t=="textarea"?this.value="":e=="checkbox"||e=="radio"?this.checked=!1:t=="select"&&(this.selectedIndex=-1)})};e.fn.resetForm=function(){return this.each(function(){(typeof this.reset=="function"||typeof this.reset=="object"&&!this.reset.nodeType)&&this.reset()})};e.fn.enable=function(e){e==undefined&&(e=!0);return this.each(function(){this.disabled=!e})};e.fn.selected=function(t){t==undefined&&(t=!0);return this.each(function(){var n=this.type;if(n=="checkbox"||n=="radio")this.checked=t;else if(this.tagName.toLowerCase()=="option"){var r=e(this).parent("select");t&&r[0]&&r[0].type=="select-one"&&r.find("option").selected(!1);this.selected=t}})}})(jQuery);